<%= include_i18n_calendar_javascript %>

<script>
jQuery.noConflict();

jQuery(document).ready(function($){

  var counter = 0;
  var locale = ""
  for (i in $.datepicker.regional) {
    if (counter == 1) {
      locale = i;
      break;
    }
    counter++;
  }

  if($("#postCheckbox").attr("checked") == false)
    $("#PostInputs").hide();

  if($("#announcementCheckbox").attr("checked") == false)
    $("#AnnouncementInputs").hide();

  $.datepicker.setDefaults( $.datepicker.regional[ '' ] );      
  $( ".datetimepicker" ).datetimepicker($.datepicker.regional[locale]);
  $( ".datepicker" ).datepicker($.datepicker.regional[locale]);

  $("#postCheckbox").click(function(){
	if($("#postCheckbox").attr("checked"))
      $("#PostInputs").show();
    else
      $("#PostInputs").hide();
  });

  $("#announcementCheckbox").click(function(){
	if($("#announcementCheckbox").attr("checked"))
      $("#AnnouncementInputs").show();
    else
      $("#AnnouncementInputs").hide();
  });

});
</script>

  <% form.inputs do %>
    <%= form.input :name, :label => t('admin.events.view.name') %>
    <%= form.input :description, :as => :text,  :label => t('admin.events.view.description') %>
    <%= form.input :starts_at,  :as => :string,
                   :input_html => { :class => "datetimepicker", :value => @record.starts_at ? l(@record.starts_at, :format => "%d/%m/%Y %H:%M") : '' }, :label => t('admin.events.view.starts_at') %>
    <%= form.input :ends_at, :as => :string,
                   :input_html => { :class => "datetimepicker", :value => @record.ends_at ? l(@record.ends_at, :format => "%d/%m/%Y %H:%M") : '' }, :label => t('admin.events.view.ends_at') %>
     <%= form.input :price, :as => :numeric, :label => t('admin.events.view.price') %>
     <%= form.input :participation_message, :as => :text, :label => t('admin.events.view.participation_message'), :required => false %>	 
  <% end %>
	
  <div class="fields">	
    <%= link_to_add_fields t("admin.events.add_activity"), form, :event_activities %>	
  </div>	
  
  <% if !@record.post || (@record.post && @record.post.title.blank?) %>
    <input id="postCheckbox" type="checkbox" /> <%= t('admin.events.view.hasPost') %>
  <% else %>
    <input id="postCheckbox" type="checkbox" checked /> <%= t('admin.events.view.hasPost') %>
  <% end %>

  <% form.inputs :name => "Post", :id  => "PostInputs" do %>

  <% form.semantic_fields_for :post_elem, @record.post do |post| %>
      <%= post.input :title,
	                 :label    => t('admin.posts.columns.title') %>
	  <%= post.input :body,
	                 :label    => t('admin.posts.columns.body'),
	                 :hint     => t('admin.posts.form.hints.body').html_safe %>
	  <%= post.input :tag_list,
	               :as       => 'string',
	               :required => false,
	               :label    => t('admin.posts.columns.tag_list'),
	               :hint     => t('admin.posts.form.hints.tag_list') %>
	  <% if @record.post && @record.post.image.content_type %>
	    <span class="file_icon"><%= image_tag file_icon_displayer(@record.post.image) %></span>
	  <% end %>
	  <%= post.input :image,
	                 :required => false,
	  	   		     :as => :file,
	                 :hint     => t('admin.posts.form.hints.image'),
	                 :label    => t('admin.posts.columns.image') %>
	  <% if @record.post && @record.post.generic.content_type %>
	    <span class="file_icon"><%= image_tag file_icon_displayer(@record.post.generic) %></span>
	  <% end %>
	  <%= post.input :generic,
	                 :required => false,
	    			 :as => :file,
	                 :hint     => t('admin.posts.form.hints.generic_file'),
	                 :label    => t('admin.posts.columns.generic_file') %>
	  <%= post.input :published_at,
	                 :as       => :string,
	                 :input_html => {:class => "datepicker", :value => l((@record.post && @record.post.published_at) ? @record.post.published_at : Time.now, :format => "%d/%m/%Y")},
	                 :label    => t('admin.posts.columns.published_at'),
	                 :hint     => t('admin.posts.form.hints.published_at').html_safe %>  
	  <%= post.input :slug,
	                 :required => false,
	                 :label    => t('admin.posts.columns.slug'),
	                 :hint     => t('admin.posts.form.hints.slug') %>
  <% end %>
 
  <% end %>
	
	<% if !@record.announcement || (@record.announcement && @record.announcement.title.blank?) %>
	  <input id="announcementCheckbox" type="checkbox" /> <%= t('admin.events.view.hasAnnouncement') %>
	<% else %>
	  <input id="announcementCheckbox" type="checkbox" checked /> <%= t('admin.events.view.hasAnnouncement') %>
	<% end %>
			
	<% form.inputs :name => "Announcement", :id  => "AnnouncementInputs" do %>
	
	<% form.semantic_fields_for :announcement_elem, @record.announcement do |announcement| %>
	  <%= announcement.input :title,
	                         :label    => I18n::t('admin.announcements.columns.title') %>
	  <%= announcement.input :starts_at,
	                         :as => :string,
	                         :input_html => { :class => "datepicker", :value => (@record.announcement && @record.announcement.starts_at) ? l(@record.announcement.starts_at, :format => "%d/%m/%Y %H:%M") : '' },
	                         :label    => I18n::t('admin.announcements.columns.starts_at') %>
	  <%= announcement.input :ends_at,
	                         :as => :string,
	                         :input_html => { :class => "datepicker", :value => (@record.announcement && @record.announcement.ends_at) ? l(@record.announcement.ends_at, :format => "%d/%m/%Y %H:%M") : '' },
	                         :label    => I18n::t('admin.announcements.columns.ends_at') %>
	  <%= announcement.input :url,
	                         :required => false,
	                         :hint     => I18n::t('admin.announcements.form.hints.url'),
	                         :label    => I18n::t('admin.announcements.columns.url') %>
	  <%= announcement.input :avatar,
	                         :required => false,
	                         :hint     => I18n::t('admin.announcements.form.hints.avatar'),
	                         :label    => I18n::t('admin.announcements.columns.avatar') %>
	  <%= announcement.input :priority,
	                         :as         => 'select',
	                         :required   => false,
	                         :collection => (1..99),
	                         :selected   => (@record.announcement && @record.announcement.priority) ? @record.announcement.priority : '',
	                         :label      => I18n::t('admin.pages.columns.priority'),
	                         :hint       => I18n::t('admin.pages.form.hints.priority') %>
	  <%= announcement.input :message,
	                         :required => false,
	                         :hint     => I18n::t('admin.announcements.form.hints.message'),
	                         :label    => I18n::t('admin.announcements.columns.message') %>
	<% end %>
	
	<% end %>
	

     
