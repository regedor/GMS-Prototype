<% content_for :page_title do %>
  <%= posts_title(@tags) %>
<% end -%>


<% content_for :head do %>
  <%= auto_discovery_link_tag(:atom, @tags.nil? ? posts_path(:format => 'atom') : posts_path(:tags => @tags, :format => 'atom')) %>
<% end %>


<% content_for :tag_cloud do %>
  <div id="tag-cloud">
    <h2 class="title"><%= I18n::t('posts.tags.title') %></h2>
    <% tag_cloud @tags_for_cloud, ['nube1', 'nube2', 'nube3', 'nube4', 'nube5'] do |name, css_class| %>
      <% classes = (@tags && (@tags.include? name)) ? (css_class + ' selected') : css_class %>
      <%= link_to name, posts_path(:tags => @tags, :this_tag => name), :class => classes %>
    <% end %>
  </div>
<% end %>


<% content_for :tag_menu do %>
  <div id="tag-menu">
    <h2 class="title"><%= I18n::t('posts.tag_menu.title') %></h2>
    <ul>
      <% tag_cloud @tags_for_cloud, ['category'] do |name, css_class| %>
        <% classes = (@tags && (@tags.include? name)) ? (css_class + ' selected') : css_class %>
        <li><%= link_to name, posts_path(:tags => @tags, :this_tag => name), :class => classes %></li>
      <% end %>
    </ul>
  </div>
<% end %>


<% content_for(:calendar) do %>
  <%= render :partial => 'calendar/calendar' %>
<% end %>


<div id="posts">
  <% if @tags %>
    <div id="tag-search-bar">
      <span id="tagged-with"><%= t('posts.tags.tagged_with') %></span>
      <span id="clear-link">(<%= link_to t('posts.tags.clear_selection'), posts_path %>)</span>
      <div id="tags"><%= (@tags.map do |tag| link_to tag, posts_path(:tags => @tags, :this_tag => tag) end).join %></div>
    </div>
  <% end -%>
    
  <% if @posts.empty? -%>
    <p><%= t('posts.none') %></p>
  <% else -%>
    <% @posts.each do |post| -%>
      <div id="post-<%= post.id %>" class="post">
        <%= render :partial => 'post', :locals => {:post => post, :event => nil} %>
      </div>
    <% end -%>
  <% end -%>
  <%= will_paginate(@posts, :previous_label => t('posts.pagination.previous'),
                            :next_label     => t('posts.pagination.next')) %>
</div>

<div id="archives">
  <%= link_to(I18n::t('posts.archive'), archives_path) %>
</div>
